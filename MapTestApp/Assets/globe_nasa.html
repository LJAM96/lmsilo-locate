<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Globe.GL + NASA</title>
    <style>
        body { margin: 0; background: #0a0a0a; overflow: hidden; }
        #globeViz { width: 100vw; height: 100vh; }
    </style>
</head>
<body>
    <div id="globeViz"></div>

    <script src="https://unpkg.com/three@0.150.0/build/three.min.js"></script>
    <script src="https://unpkg.com/globe.gl@2.24.0/dist/globe.gl.min.js"></script>

    <script>
        // Note: In production, download NASA texture locally
        const earthTexture = 'https://eoimages.gsfc.nasa.gov/images/imagerecords/79000/79793/dnb_land_ocean_ice.2012.3600x1800.jpg';

        window.globe = Globe()
            .globeImageUrl(earthTexture)
            .backgroundImageUrl('https://unpkg.com/three-globe@2.24.0/example/img/night-sky.png')
            .atmosphereColor('#1a1a2e')
            .atmosphereAltitude(0.15)
            .showAtmosphere(true)
            .width(window.innerWidth)
            .height(window.innerHeight)
            (document.getElementById('globeViz'));

        globe.controls().autoRotate = false;
        globe.controls().enableDamping = true;
        globe.controls().dampingFactor = 0.1;
        globe.controls().rotateSpeed = 0.5;
        globe.pointOfView({ lat: 0, lng: 0, altitude: 2.5 }, 0);

        window.pins = [];

        function getColor(confidence) {
            if (confidence >= 0.85) return '#00ff88';
            if (confidence >= 0.50) return '#ffdd00';
            return '#ff6666';
        }

        window.mapAPI = {
            addPin: function(lat, lon, label, confidence, rank, isExif) {
                window.pins.push({
                    lat: lat,
                    lng: lon,
                    size: rank === 1 ? 1.0 : 0.7,
                    color: isExif ? '#00ffff' : getColor(confidence),
                    altitude: rank === 1 ? 0.012 : 0.008,
                    label: label
                });
                globe.pointsData(window.pins)
                    .pointLat('lat')
                    .pointLng('lng')
                    .pointColor('color')
                    .pointAltitude('altitude')
                    .pointRadius('size')
                    .pointLabel('label');
            },
            flyTo: function(lat, lon, zoom, duration) {
                globe.pointOfView({ lat: lat, lng: lon, altitude: 2.0 }, duration || 1000);
            }
        };

        window.addEventListener('resize', () => {
            globe.width(window.innerWidth);
            globe.height(window.innerHeight);
        });

        console.log('Globe.GL + NASA initialized');
    </script>
</body>
</html>
